<draw>
#plots my_plot
saveAs png pdf root C
outDir /afs/cern.ch/user/n/nchernya/www/HHbbgg/thesis/MVA_ggF_dataMC/
plugins 'gStyle->SetOptStat("mre")' 'gStyle->SetLegendBorderSize(0)'  '$CMSSW_BASE/src/ExternalTools/FuriousPlotter/scripts/macros/FPCanvasStyle.C' '$CMSSW_BASE/src/ExternalTools/FuriousPlotter/scripts/macros/rootlogon.C' 
</draw>

<info>
tuplesDir /eos/user/n/nchernya/HHbbgg_ntuples/HHbbgg_preselection_ntuples/20192401_wo_Mjj_leptonveto_flashgg/
lumi16 35.9
lumi17 41.5
lumi18 59.4
#lumisig is multiplied with xsec x BR = 31.05*0.58*0.00227*2 
lumi16sig 2935.2
lumi17sig 3393.1
lumi18sig 4856.5
lumifull 137
lumifullsig 11201
</info>

variables MVAOutputTransformed 

#variables absCosTheta_gg absCosTheta_bb absCosThetaStar_CS customSubLeadingPhotonIDMVA customLeadingPhotonIDMVA diphotonPtOverdiHiggsM dijetPtOverdiHiggsM leadingJet_DeepFlavour subleadingJet_DeepFlavour sigmaMOverM sigmaMJets_gauss PhoJetMinDr PhoJetOtherDr leadingPhotonSigOverE subleadingPhotonSigOverE leadingJet_bRegNNResolution_gauss subleadingJet_bRegNNResolution_gauss leadingJet_pt_Over_Mjj subleadingJet_pt_Over_Mjj leadingPhoton_pt_Over_CMS_hgg_mass subleadingPhoton_pt_Over_CMS_hgg_mass
<sw>
#labels '|cos(#theta_{#gamma#gamma})|' '|cos(#theta_{jj})|' '|cos#theta*|_{CS}' 'Photon ID #gamma_2' 'Photon ID #gamma_1' 'p_{T}(#gamma#gamma)/M_{jj#gamma#gamma}' 'p_{T}(jj)/M_{jj#gamma#gamma}' 'Deep Flavour leading jet' 'Deep Flavour subleading jet' '#sigma_{m_{#gamma#gamma}}/m_{#gamma#gamma}' '#sigma_{m_{jj}}/m_{jj}' 'min #DeltaR(#gamma,jet)' 'other #DeltaR(#gamma,jet)' 'Leading Photon #sigma_{E}/E' 'Subleading Photon #sigma_{E}/E' 'Leading Jet #sigma_{p_{T}}/p_{T}' 'Subleading Jet #sigma_{p_{T}}/p_{T}' 'p_{T}(j_{1})/m_{jj}' 'p_{T}(j_{2})/m_{jj}' 'p_{T}(#gamma_{1})/m_{#gamma#gamma}' 'p_{T}(#gamma_{2})/m_{#gamma#gamma}'
#bins 50 50 50 50 50 50 50 50 50 50 50 50 40 50 50 50 50 50 50 50 50  
#min  0 0 0 -1 -1 0 0 0 0   0   0  0 0   0   0    0   0   0 0 0 0
#max  1 1 1  1  1 1 1 1 1  0.06 0.4 6 5  0.06 0.06 0.4 0.4  3 3 3 3

labels 'ggF MVA' 
bins 63 
min 0.37 
max 1 

</sw>


for iv,var variables
<my_plot_$var>

#customize 'macro:FPCanvasStyle(this, "", "13 TeV", 0, "Simulation", 1)' 
customize 'macro:FPCanvasStyle(this, "CMS", "137 fb^{-1} (13 TeV)", 0, "Private Work", 1)' 'SetLogy()'

#legendHeader 'Legend :'
#legendXY 0.55 0.55 0.82 0.93 
legendXY 0.2 0.75 0.93 0.95 
legendColumns 2
histos dipho data gjets sig

<dipho20170>
      src $info.tuplesDir[0]/output_DiPhotonJetsBox__2017.root DiPhotonJetsBox_MGG_80toInf_13TeV_Sherpa_13TeV_DoubleHTag_0
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi17[0]*weight*(MVAOutputTransformed>0.37)*2.9'
      customize  'SetMinimum(10E-04)'
</dipho20170>

<dipho20171>
      src $info.tuplesDir[0]/output_DiPhotonJetsBox1BJet_2017.root DiPhotonJetsBox1BJet_MGG_80toInf_13TeV_Sherpa_13TeV_DoubleHTag_0
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi17[0]*weight*overlapSave*(MVAOutputTransformed>0.37)*2.9'
</dipho20171>

<dipho20172>
      src $info.tuplesDir[0]/output_DiPhotonJetsBox2BJets_2017.root DiPhotonJetsBox2BJets_MGG_80toInf_13TeV_Sherpa_13TeV_DoubleHTag_0
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi17[0]*weight*overlapSave*(MVAOutputTransformed>0.37)*2.9'
</dipho20172>


<dipho20180>
      src $info.tuplesDir[0]/output_DiPhotonJetsBox__2017.root DiPhotonJetsBox_MGG_80toInf_13TeV_Sherpa_13TeV_DoubleHTag_0
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi18[0]*weight*(MVAOutputTransformed>0.37)*2.9'
      customize  'SetMinimum(10E-04)'
</dipho20180>

<dipho20181>
      src $info.tuplesDir[0]/output_DiPhotonJetsBox1BJet_2018.root DiPhotonJetsBox1BJet_MGG_80toInf_13TeV_Sherpa_13TeV_DoubleHTag_0
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi18[0]*weight*overlapSave*(MVAOutputTransformed>0.37)*2.9'
</dipho20181>

<dipho20182>
      src $info.tuplesDir[0]/output_DiPhotonJetsBox2BJets_2018.root DiPhotonJetsBox2BJets_MGG_80toInf_13TeV_Sherpa_13TeV_DoubleHTag_0
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi18[0]*weight*overlapSave*(MVAOutputTransformed>0.37)*2.9'
</dipho20182>


<dipho20160>
      src $info.tuplesDir[0]/output_DiPhotonJetsBox__2016.root DiPhotonJetsBox_MGG_80toInf_13TeV_Sherpa_13TeV_DoubleHTag_0
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi16[0]*weight*(MVAOutputTransformed>0.37)*2.9'
      customize  'SetMinimum(10E-04)'
</dipho20160>

<dipho20161>
      src $info.tuplesDir[0]/output_DiPhotonJetsBox1BJet_2016.root DiPhotonJetsBox1BJet_MGG_80toInf_13TeV_Sherpa_13TeV_DoubleHTag_0
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi16[0]*weight*overlapSave*(MVAOutputTransformed>0.37)*2.9'
</dipho20161>

<dipho20162>
      src $info.tuplesDir[0]/output_DiPhotonJetsBox2BJets_2016.root DiPhotonJetsBox2BJets_MGG_80toInf_13TeV_Sherpa_13TeV_DoubleHTag_0
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi16[0]*weight*overlapSave*(MVAOutputTransformed>0.37)*2.9'
</dipho20162>

<dipho>
       src my_plot_$var.dipho20160 my_plot_$var.dipho20161 my_plot_$var.dipho20162 my_plot_$var.dipho20170 my_plot_$var.dipho20171 my_plot_$var.dipho20172 my_plot_$var.dipho20180 my_plot_$var.dipho20181 my_plot_$var.dipho20182
       operations 'Add(Add(Add(dipho20160, dipho20161),dipho20162),Add(Add(dipho20170, dipho20171),dipho20172),Add(Add(dipho20180, dipho20181),dipho20182))'
       #customize 'SetTitle(";$sw.labels[$iv];Normalized to Unity")' 'Scale(1./this->Integral())'  'SetLineColor(kAzure-3)' 'SetFillColor(kAzure-3)' 'SetFillStyle(3325)'  'SetLineStyle(1)' 'SetLineWidth(2)'  'SetMaximum(1.3*this->GetMaximum())' 'SetMinimum(0.8*this->GetMinimum())'
       customize 'SetTitle(";$sw.labels[$iv];Events / %.2f%this->GetBinWidth(1)")'  'SetLineColor(kAzure-3)' 'SetFillColor(kAzure-3)' 'SetFillStyle(3325)'  'SetLineStyle(1)' 'SetLineWidth(2)'  'SetMaximum(50*this->GetMaximum())' 'SetMinimum(10E-04)'

       legendEntry '#gamma#gamma + jets' F
       drawOptions HIST 
</dipho>


<gjets170>
      src $info.tuplesDir[0]/output_GJet_Pt-20to40_2017.root  GJet_Pt_20to40_DoubleEMEnriched_MGG_80toInf_TuneCP5_13TeV_Pythia8_13TeV_DoubleHTag_0
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi17[0]*weight*(MVAOutputTransformed>0.37)*2.9'
</gjets170>

<gjets171>
      src $info.tuplesDir[0]/output_GJet_Pt-40toInf_2017.root GJet_Pt_40toInf_DoubleEMEnriched_MGG_80toInf_TuneCP5_13TeV_Pythia8_13TeV_DoubleHTag_0
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi17[0]*weight*(MVAOutputTransformed>0.37)*2.9'
</gjets171>

<gjets160>
      src $info.tuplesDir[0]/output_GJet_Pt-20to40_2016.root GJet_Pt_20to40_DoubleEMEnriched_MGG_80toInf_TuneCUETP8M1_13TeV_Pythia8_13TeV_DoubleHTag_0 
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi16[0]*weight*(MVAOutputTransformed>0.37)*2.9'
</gjets160>

<gjets161>
      src $info.tuplesDir[0]/output_GJet_Pt-40toInf_2016.root GJet_Pt_40toInf_DoubleEMEnriched_MGG_80toInf_TuneCUETP8M1_13TeV_Pythia8_13TeV_DoubleHTag_0 
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi16[0]*weight*(MVAOutputTransformed>0.37)*2.9'
</gjets161>

<gjets180>
      src $info.tuplesDir[0]/output_GJet_Pt-20to40_2018.root  GJet_Pt_20to40_DoubleEMEnriched_MGG_80toInf_TuneCP5_13TeV_Pythia8_13TeV_DoubleHTag_0
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi18[0]*weight*(MVAOutputTransformed>0.37)*2.9'
</gjets180>

<gjets181>
      src $info.tuplesDir[0]/output_GJet_Pt-40toInf_2018.root GJet_Pt_40toInf_DoubleEMEnriched_MGG_80toInf_TuneCP5_13TeV_Pythia8_13TeV_DoubleHTag_0
      var '$var'
      bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
      cut '$info.lumi18[0]*weight*(MVAOutputTransformed>0.37)*2.9'
</gjets181>


<gjets>
       src my_plot_$var.gjets160 my_plot_$var.gjets161  my_plot_$var.gjets170 my_plot_$var.gjets171  my_plot_$var.gjets180 my_plot_$var.gjets181 
       operations 'Add(Add(gjets160,gjets161),Add(Add(gjets170,gjets171),Add(gjets180,gjets181)))'
       customize 'SetLineColor(kSpring+5)' 'SetFillColor(kSpring+5)' 'SetFillStyle(3352)'  'SetLineStyle(1)' 'SetLineWidth(2)'
       legendEntry '#gammaj + jets' F
       drawOptions HIST 
</gjets>

<sig>
       src $info.tuplesDir[0]/hh_2017_SMsignal_transformedMVA.root reducedTree
       var '$var'
       cut '$info.lumifullsig[0]*weight*(MVAOutputTransformed>0.37)'
       bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
       #customize+= 'SetLineColor(kRed)'  'Scale(1./this->Integral())' 'SetLineStyle(1)' 'SetLineWidth(2)' 'SetMaximum(1.3*this->GetMaximum())' 'SetMinimum($sw.ymin[$iv])'
       customize+= 'SetLineColor(kRed)'   'SetLineStyle(1)' 'SetLineWidth(2)'
       legendEntry 'ggF HH#rightarrow#gamma#gammab#bar{b} x 10^{3}' l
       drawOptions HIST 
</sig>


<data>
       src $info.tuplesDir[0]/DoubleEG_2016_2017_2018_24_01_2020_transformedMVA.root Data_13TeV_DoubleHTag_0
       var '$var'
       cut '1*(MVAOutputTransformed>0.37)'
       bins $sw.bins[$iv] $sw.min[$iv] $sw.max[$iv]
       customize+= 'SetLineColor(kBlack)' 'SetMarkerColor(kBlack)' 'SetMarkerStyle(20)'
       legendEntry 'Data' PE
       drawOptions PE 
</data>


</my_plot_$var>

draw.plots+= my_plot_$var
end
